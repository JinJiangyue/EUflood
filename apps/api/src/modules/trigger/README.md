# 触发器模块（Trigger Module）

## 设计理念

使用**高准确性、覆盖全欧洲的降雨/洪水监控源**作为"触发器"，当检测到特定位置有降雨/洪水时，自动触发对应国家的官方数据源采集。

## 流程

```
触发器源（实时监控）
  ↓
检测到降雨/洪水事件（位置+时间+强度）
  ↓
地理定位（坐标 → 国家映射）
  ↓
调用对应国家数据源（官方API/RSS）
  ↓
数据入库（标记触发来源）
```

## 推荐的触发器源

### 1. Open-Meteo API（推荐）
- **URL**: https://api.open-meteo.com/v1/forecast
- **覆盖**: 全欧洲，高精度网格
- **数据**: 实时降雨、预报、历史数据
- **费用**: 免费
- **准确性**: 高（基于ECMWF模型）
- **优势**: 
  - 无需API Key
  - 支持批量查询
  - 提供降水累计、小时数据
  - 覆盖所有欧盟国家

### 2. EFAS (欧洲洪水预警系统)
- **类型**: 专业洪水预警
- **覆盖**: 欧洲范围
- **准确性**: 极高（专门用于洪水预警）
- **状态**: 需要查看访问方式

### 3. CEMS (哥白尼应急管理服务)
- **类型**: 全球洪水监测
- **覆盖**: 全球
- **准确性**: 高
- **状态**: 需要查看API访问方式

## 触发器配置

在 `trigger/config.ts` 中配置：
- 监控区域（欧洲边界坐标）
- 降雨阈值（触发阈值，如 >5mm/h）
- 检查频率（如每10分钟）
- 国家映射规则

## 国家映射

当触发器检测到事件时，根据坐标确定国家：
- 使用坐标 → 国家映射表（或地理编码API）
- 调用对应国家的数据采集器

